---
layout: post
title: 移动目标防御MTD
categories: CyberSecurity
description: 移动目标防御学习笔记
keywords: 主动防御, MTD

---


> 移动目标防御（MTD）是一种新颖的主动技术，旨在通过在攻击侦察和计划中施加不确定性来击败攻击。



# 移动目标防御



> 移动目标防御（MTD）是一种新颖的主动技术，旨在通过在攻击侦察和计划中施加不确定性来击败攻击。这种不确定性是通过攻击者无法追踪（可预测）的方式对系统配置进行频繁且随机的突变（随机化）来实现的。
>
> MTD通过动态地改变基础设施，持续地改变攻击面，攻击者被迫要调用非常大的资源不断分析探测这种变化的架构，且随着时间的推移而难度增大。
>
> 目标的变化性；变化的可管理性；变化的持续性；变化的快速性；变化的多样性；变化的难以预测性





## 攻击面的动态转移技术

系统的**攻击面**指的是能够被攻击者利用并对该系统发动攻击的系统资源。

**攻击面动态转移**技术主要通过改变特定系统资源属性或属性对外的呈现信息，使其攻击面发生变化，从而迷惑或误导攻击者，促使攻击者攻击错误目标或丢失攻击目标，改变网络防御被动的局面，提高系统的安全性。

要转移攻击面，防御者需要至少满足以下条件之一：

- 改变所利用的某一类攻击面资源(例如, 防御者可以修改IP地址、系统开放的端口数量等)；
- 改变某一类攻击面资源对攻击面的影响力大小(例如, 防御者可以修改执行某些命令所需的权限等).



**按攻击面层次分类**

- 基于数据攻击面的动态转移技术：根据系统的防御需求，在保持数据语义不发生变更的前提下，通过对选定数据的形式、编码、格式、排列等进行动态变换，实现脆弱性的规避或者攻击行为的发现，从而提升系统的安全性
  - 数据随机化：基本思路主要是改变数据在存储器中的存储方式，利用随机生成的密钥，通过异或操作对不同的数据对象(例如指令操作数、数组、指针等)进行随机化操作，使得存储器中的数据形式呈现随机动态变化的特性，从而使攻击者攻击时访问内存错误或无法跳转至恶意代码指向地址，以挫败缓冲区溢出攻击；
  - 数据多样化：基本思想主要是通过对数据集进行多样化处理，构造等价或等语义的多个数据集，再监测测试过程中的行为与输出，以鉴别系统或程序运行过程中是否存在攻击行为，解决其自身的设计缺陷问题；
    - 多副本运行
    - 多变体数据
- 基于软件攻击面的动态转移技术：通过密码技术和编译技术，对软件代码在地址空间布局、指令集、内存空间布局、程序的结构布局等方面采取动态化、随机化、多样化的处理，改变了软件的同质化现象；通过动态转移软件攻击面的方式，力求增加攻击者的攻击难度，增强对于上述攻击手段的有效防御
  - 地址空间布局随机化(ASLR)：通过随机化进程地址空间的方法来实现计算机系统的多样化；ASLR可以在编译时随机化，以生成同一软件的不同版本，也可以在运行时随机化，对程序组件的地址进行动态布局；ASLR的随机化对象主要包括堆地址、栈基地址、进程环境块地址和线程环境块地址、动态链接库地址等；
  - 指令集随机化(ISR)：通过对指令集进行特殊的随机化操作(例如内核修改、脚本语言随机化、Runtime随机化、指令地址随机化等)，实现软件攻击面的动态转移；
    - 抵御Web攻击的ISR方法
    - 抵御二进制代码注入攻击的ISR方法
  - 代码随机化：针对ROP攻击等一类代码复用攻击，通过随机化方式修改二进制代码，使得攻击者无法利用程序中原有代码，试图以此抵御代码复用攻击；
  - 软件多态化：通过在软件开发过程中为同一源代码生成同一功能、不同结构的大量软件实体，使得每位用户的同一软件都存在着内部结构的差异性, 从而使得攻击者攻破不同用户的难度加大；
    - 反向堆栈技术：通过扩展原有的堆栈操作指令, 构建出一个具有向上增长堆栈的变体
    - 寄存器随机化技术：通过交换寄存器中的内容, 使得攻击者依赖原先寄存器中的固定内容发生变化
    - 指令修改技术：利用指令调度，调用内联、循环迭代分布、部分冗余删除等方法来改变生成的机器代码；向代码中插入无操作序列、引入偏移量从而改变后续代码序列位置；为现有指令进行等价指令替换
    - 多变体运行技术：同时运行多个保持相同语义的变体，并观察和监测各个变体在同步点的行为，在保证输入一致的前提下，监控程序监测到与其他变体发生不一致的行为时，对该变体是否存在攻击行为进行分析，并终止该变体继续运行，同时选用其他变体的输出作为程序执行的结果
- 基于网络攻击面的动态转移技术：切断攻击者网络侦查和探测目标漏洞，迫使攻击者不断追逐攻击目标，在不中断正常网络通信的前提下，阻止攻击者连接到目标系统或者引导攻击者连接到虚假、错误的目标，消除攻击者攻击时间、空间上的优势，阻止其进行后续攻击
  - 动态网络架构：通过实施网络攻击面资源的转移，动态变换网络资源及配置，同时保持架构内各部分组件的信息交换和协同转移，以此提高应对网络攻击的动态防御能力；
    - 可变网络(mutable networks, MUTE)
    - 自屏蔽动态网络架构(self-shielding dynamic network architecture, SDNA)
    - MOTAG架构
    - 移动自组网络(mobile ad hoc networks, MANETs)
    - 软件定义网络架构(software-defined networking, SDN)
  - 网络地址随机化：为网络地址引入动态变换更新机制，通过对网络数据包进行特殊的处理或通过一定机制协同变换网络地址，使得攻击者始终无法确定通信双方的真实地址，从而破坏了攻击者的嗅探攻击，实现了对主机的隐私保护，以此提升通信双方的安全性；
  - 端信息跳变：在端到端的数据传输中，通信双方或一方按照协定伪随机地改变端口、地址、时隙、加密算法甚至协议等信息，从而实现网络的主动防御；
- 基于平台攻击面的动态转移技术：针对传统平台单一架构的缺陷，采用构建多样化运行平台的方式，动态改变应用的运行环境和系统配置，使系统呈现出随机性、不确定性和动态性，以此来提高攻击者对系统进行攻击的难度
  - 平台动态迁移：通过构建多个平台，并使运行在其上的应用能够以可控的方式随机地在不同的平台上迁移，减少攻击者探测和攻击的成功几率，最终实现提升系统防御能力的目的；
    - 同平台的多配置迁移
    - 多平台迁移
  - 虚拟化技术：虚拟化技术包含操作系统级的虚拟机技术，又包含虚拟机、虚拟服务器等硬件级虚拟化技术，虚拟化技术的应用在很大程度上解决了原先很多在实际网络环境中难以实现或难以部署的动态迁移方法，使得网络攻击面的动态转移方法有了更深入、更广泛的应用；
  - Web应用动态防御
  - 移动平台动态防御



**按转移方法分类**

- 扰乱：通过将系统的配置进行动态调整，达到扰乱攻击者攻击行为的目的，比如IP地址、端口的跳变。此外，通过结合SDN技术可以方便地进行地址、端口的跳变。
  - IP、端口等的动态变化有可能会干扰网络的正常运行，避免现有网络中“扰乱”的干扰；
  - 扰乱机制带来的额外系统开销。
- 多样化：提供具有相同功能，不同实现的输入、解释器、软件栈组件等达到抵御攻击者攻击。多样化通常是从底层或软件、服务器等高层将地址空间、指令集、数据、软件版本、服务运行环境等进行多样性处理，使得攻击者的攻击危害大大降低。
  - 多样化处理往往会增加开发者的开发成本；
  - 服务提供商需要更多的资源以进行攻击表面的转移。
- 冗余：通过提供数据、服务或节点的多个副本，判断系统是否遭到攻击来保护系统。
  - 需要提供一定量的冗余资源；
  - 不适用数据中心等提供大量服务和数据的运行场景。



## 攻击表面的转移策略

攻击表面根据外部环境变化应采取什么样的转移策略，包括：

- 攻击表面应该以什么样的时间间隔进行转移——攻击表面转移较快可以提高系统的安全性，却会带来系统开销的增大和可用性的下降；
- 在攻击者和防御方的动态竞争中，如何得到防御方的最佳防御策略。



攻击面动态转移的策略不同方法有：

- 博弈论方法：通过对攻击者和防御方之间的动作、状态、攻击面转移作为特征，以双方的收益与付出作为评估标准，将攻击方和防御方之间的攻防过程建立博弈模型，以此求解防御方的最佳攻击面转移策略；
- 基于Markov模型的策略生成方法
- 基于网络攻击面的自适应转换技术







1. [（安全内参）移动目标防御技术研究综述](https://www.secrss.com/articles/33311)
2. [周余阳, 程光, 郭春生, 戴冕. 移动目标防御的攻击面动态转移技术研究综述. 软件学报, 2018, 29(9): 2799-2820.](http://www.jos.org.cn/1000-9825/5597.htm)
3. 